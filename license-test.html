<!DOCTYPE html>
<html lang="en">
<!--
 Title: myTheme | MikroTik Hotspot Theme
 Codename: Nebula
 Version: 4.65
 Repository: https://github.com/hpy-git/myTheme
 Author: HPY | hpy-git
 -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>License Verification Test</title>
    <style>
        body {
            font-family: monospace;
            background: #0f172a;
            color: #f1f5f9;
            padding: 40px;
            line-height: 1.8;
        }
        .status {
            padding: 20px;
            border-radius: 16px;
            margin: 20px 0;
        }
        .success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid #10b981;
        }
        .error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid #ef4444;
        }
        .key {
            background: rgba(59, 130, 246, 0.1);
            padding: 8px 12px;
            border-radius: 10px;
            display: inline-block;
            margin: 4px 0;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-family: monospace;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
    </style>
</head>
<body>
    <h1>üîê License Verification System</h1>
    
    <div id="results"></div>
    
    <h3>Manual Tests:</h3>
    <button onclick="testLicensePresence()">1. Check License Loaded</button>
    <button onclick="testValidation()">2. Validate License Key</button>
    <button onclick="testChecksum()">3. Verify Checksum</button>
    <button onclick="testSystemCheck()">4. Test System Check</button>
    <button onclick="testTamperProtection()">5. Test Tamper Protection</button>
    
    <script src="js/license.js"></script>
    <script>
        const results = document.getElementById('results');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = 'status ' + (type === 'success' ? 'success' : type === 'error' ? 'error' : '');
            div.innerHTML = message;
            results.appendChild(div);
        }
        
        function testLicensePresence() {
            results.innerHTML = '';
            if (typeof window._LIC_STATE !== 'undefined') {
                log('‚úÖ License state detected: <span class="key">' + window._LIC_STATE + '</span>', 'success');
            } else {
                log('‚ùå License state NOT found!', 'error');
            }
            
            if (typeof __systemCheck === 'function') {
                log('‚úÖ System check function exists', 'success');
            } else {
                log('‚ùå System check function NOT found!', 'error');
            }
        }
        
        function testValidation() {
            results.innerHTML = '';
            const key = 'XK9P-7M4N-3RW8-VJ2Q';
            try {
                const result = __systemCheck();
                if (result === true) {
                    log('‚úÖ License key validated: <span class="key">' + key + '</span>', 'success');
                } else {
                    log('‚ùå License validation failed', 'error');
                }
            } catch (e) {
                log('‚ùå Error: ' + e.message, 'error');
            }
        }
        
        function testChecksum() {
            results.innerHTML = '';
            const key = 'XK9P-7M4N-3RW8-VJ2Q';
            let sum = 0;
            for (let i = 0; i < key.length; i++) {
                if (key[i] !== '-') {
                    sum += key.charCodeAt(i);
                }
            }
            if (sum === 936) {
                log('‚úÖ Checksum valid: <span class="key">' + sum + '</span>', 'success');
            } else {
                log('‚ùå Checksum invalid: Expected 936, got ' + sum, 'error');
            }
        }
        
        function testSystemCheck() {
            results.innerHTML = '';
            if (window._LIC_STATE === true) {
                log('‚úÖ System state: ACTIVE', 'success');
                log('‚úÖ All protected functions will execute', 'success');
            } else {
                log('‚ùå System state: INACTIVE', 'error');
                log('‚ùå Protected functions will be blocked', 'error');
            }
        }
        
        function testTamperProtection() {
            results.innerHTML = '';
            try {
                // Try to modify the license state
                const originalState = window._LIC_STATE;
                window._LIC_STATE = false;
                
                if (window._LIC_STATE === false) {
                    log('‚ö†Ô∏è WARNING: License state was modified!', 'error');
                    log('This should not be possible with proper protection', 'error');
                    // Restore
                    window._LIC_STATE = originalState;
                } else {
                    log('‚úÖ License state is write-protected', 'success');
                }
            } catch (e) {
                log('‚úÖ Tamper protection active: ' + e.message, 'success');
            }
        }
        
        // Auto-run tests on load
        setTimeout(() => {
            log('<h2>Automatic Verification</h2>');
            testLicensePresence();
            testValidation();
            testChecksum();
            testSystemCheck();
        }, 100);
    </script>
</body>
</html>
